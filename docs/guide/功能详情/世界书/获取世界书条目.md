# è·å–ä¸–ç•Œä¹¦æ¡ç›®

:::tip
è¯·åŠ¡å¿…å…ˆé˜…è¯»[å¦‚ä½•æ­£ç¡®ä½¿ç”¨é…’é¦†åŠ©æ‰‹](/guide/åŸºæœ¬ç”¨æ³•/å¦‚ä½•æ­£ç¡®ä½¿ç”¨é…’é¦†åŠ©æ‰‹.md)
:::

<CustomTOC />

## getLorebookEntries

è·å–ä¸–ç•Œä¹¦ä¸­çš„æ¡ç›®ä¿¡æ¯ã€‚

:::code-group

```typescript [getLorebookEntries]
function getLorebookEntries(lorebook: string): Promise<LorebookEntry[]>;
```

```typescript [GetLorebookEntriesOption]
interface GetLorebookEntriesOption {
  filter?: "none" | Partial<LorebookEntry>; // æŒ‰ç…§æŒ‡å®šå­—æ®µå€¼ç­›é€‰æ¡ç›®
}
```

```typescript [LorebookEntry]
interface LorebookEntry {
  uid: number; // uid æ˜¯ç›¸å¯¹äºä¸–ç•Œä¹¦å†…éƒ¨çš„ï¼Œä¸è¦è·¨ä¸–ç•Œä¹¦ä½¿ç”¨
  display_index: number; // é…’é¦†ä¸­å°†æ’åºè®¾ç½®ä¸º "è‡ªå®šä¹‰" æ—¶çš„æ˜¾ç¤ºé¡ºåº

  comment: string;
  enabled: boolean;
  type: "constant" | "selective" | "vectorized";
  position:
    | "before_character_definition" // è§’è‰²å®šä¹‰ä¹‹å‰
    | "after_character_definition" // è§’è‰²å®šä¹‰ä¹‹å
    | "before_example_messages" // ç¤ºä¾‹æ¶ˆæ¯ä¹‹å‰
    | "after_example_messages" // ç¤ºä¾‹æ¶ˆæ¯ä¹‹å
    | "before_author_note" // ä½œè€…æ³¨é‡Šä¹‹å‰
    | "after_author_note" // ä½œè€…æ³¨é‡Šä¹‹å
    | "at_depth_as_system" // @Dâš™
    | "at_depth_as_assistant" // @DğŸ‘¤
    | "at_depth_as_user"; // @DğŸ¤–
  depth: number | null; // ä»…å¯¹äº `position === 'at_depth_as_???'` æœ‰æ„ä¹‰ï¼›å…¶ä»–æƒ…å†µä¸º null
  order: number;
  probability: number;

  keys: string[];
  logic: "and_any" | "and_all" | "not_all" | "not_any";
  filters: string[];

  scan_depth: "same_as_global" | number;
  case_sensitive: "same_as_global" | boolean;
  match_whole_words: "same_as_global" | boolean;
  use_group_scoring: "same_as_global" | boolean;
  automation_id: string | null;

  exclude_recursion: boolean;
  prevent_recursion: boolean;
  delay_until_recursion: boolean | number; // å¯ç”¨åˆ™æ˜¯ true, å¦‚æœè®¾ç½®äº†å…·ä½“çš„ Recursion Level åˆ™æ˜¯æ•°å­—

  content: string;

  group: string;
  group_prioritized: boolean;
  group_weight: number;
  sticky: number | null;
  cooldown: number | null;
  delay: number | null;
}
```

:::

### å‚æ•°

#### `lorebook`

- **ç±»å‹**: `string`
- **æè¿°**: ä¸–ç•Œä¹¦åç§°

:::warning
æ³¨æ„ï¼šç±»å‹å®šä¹‰ä¸­ `getLorebookEntries` ä¸å†æ¥å— `option` å‚æ•°ï¼Œä¸ºäº†ä¿æŒå…¼å®¹æ€§ï¼Œå¦‚æœéœ€è¦ç­›é€‰ï¼Œè¯·è·å–æ‰€æœ‰æ¡ç›®åè‡ªè¡Œç­›é€‰ã€‚
:::

### ç¤ºä¾‹

:::code-group

```typescript [è·å–æ‰€æœ‰æ¡ç›®]
// è·å–ä¸–ç•Œä¹¦ä¸­æ‰€æœ‰æ¡ç›®çš„æ‰€æœ‰ä¿¡æ¯
const entries = await getLorebookEntries("eramgtå°‘å¥³æ­Œå‰§");
```

```typescript [æŒ‰å†…å®¹ç­›é€‰]
// æŒ‰å†…å®¹ç­›é€‰ï¼Œcontent ä¸­å¿…é¡»å‡ºç° `'ç¥ä¹å…‰'`
const entries = await getLorebookEntries("eramgtå°‘å¥³æ­Œå‰§");
const filteredEntries = entries.filter(entry => entry.content.includes("ç¥ä¹å…‰"));
```

:::
