# ç›‘å¬å’Œå‘é€äº‹ä»¶

:::tip
è¯·åŠ¡å¿…å…ˆé˜…è¯»[å¦‚ä½•æ­£ç¡®ä½¿ç”¨é…’é¦†åŠ©æ‰‹](/guide/åŸºæœ¬ç”¨æ³•/å¦‚ä½•æ­£ç¡®ä½¿ç”¨é…’é¦†åŠ©æ‰‹.md)
:::

æ‰©å±•å…è®¸ä½ è®¾ç½®å½“å‘ç”ŸæŸç§äº‹ä»¶æ—¶ï¼Œè¿è¡Œæƒ³è¦çš„å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œä½ ä¹Ÿè®¸æƒ³åœ¨ç©å®¶æ“…è‡ªæ›´æ”¹ä½ çš„ä¸–ç•Œä¹¦æ—¶è­¦å‘Šç©å®¶ã€‚

å¯ä»¥å¤„ç†çš„äº‹ä»¶è¯·æŸ¥çœ‹[äº‹ä»¶åˆ—è¡¨](./ç›‘å¬å’Œå‘é€äº‹ä»¶#äº‹ä»¶åˆ—è¡¨)ã€‚

<CustomTOC />

## eventOn <Badge type="warning" text="ğŸš«TavernHelper" />

ç›‘å¬äº‹ä»¶ã€‚

è®© `listener` ç›‘å¬ `event_type`ï¼Œå½“äº‹ä»¶å‘ç”Ÿæ—¶è‡ªåŠ¨è¿è¡Œ `listener`ã€‚

å¦‚æœ `listener` å·²ç»åœ¨ç›‘å¬ `event_type`ï¼Œåˆ™è°ƒç”¨æœ¬å‡½æ•°ä¸ä¼šæœ‰ä»»ä½•æ•ˆæœã€‚

```typescript
function eventOn<T extends EventType>(
  event_type: T,
  listener: ListenerType[T],
): void;
```

### å‚æ•°

#### `event_type`

- **ç±»å‹**: [`EventType`](./ç›‘å¬å’Œå‘é€äº‹ä»¶#äº‹ä»¶åˆ—è¡¨)
- **æè¿°**: è¦ç›‘å¬çš„äº‹ä»¶

#### `listener`

- **ç±»å‹**: `Function`
- **æè¿°**: è¦æ³¨å†Œçš„å‡½æ•°

### ç¤ºä¾‹

:::code-group

```typescript [ç›‘å¬æ¶ˆæ¯æ¥æ”¶]
function hello() {
  alert("hello");
}
eventOn(tavern_events.MESSAGE_RECEIVED, hello);
```

```typescript [ç›‘å¬æ¶ˆæ¯æ›´æ–°]
// é…’é¦†äº‹ä»¶ tavern_events.MESSAGE_UPDATED ä¼šä¼ é€’è¢«æ›´æ–°çš„æ¥¼å±‚ id
eventOn(tavern_events.MESSAGE_UPDATED, detectMessageEdited);

function detectMessageEdited(message_id) {
  alert(`ä½ åˆšåˆšæ›´æ–°äº†ç¬¬ ${message_id} æ¡èŠå¤©æ¶ˆæ¯å¯¹å§ğŸ˜¡`);
}
```

:::

## eventOnButton <Badge type="warning" text="ğŸš«TavernHelper" />

ç›‘å¬è„šæœ¬åº“ä¸­çš„æŒ‰é”®äº‹ä»¶ã€‚

```typescript
function eventOnButton<T extends EventType>(event_type: T, listener: ListenerType[T]): void
```

### å‚æ•°

#### `event_type`

- **ç±»å‹**: `string`
- **æè¿°**: åœ¨[æŒ‰é”®ç»‘å®š](/guide/åŸºæœ¬ç”¨æ³•/è„šæœ¬åº“#æŒ‰é”®ç»‘å®š)ä¸­è®¾å®šçš„æŒ‰é”®åç§°

#### `listener`

- **ç±»å‹**: `Function`
- **æè¿°**: è¦æ³¨å†Œçš„å‡½æ•°

### ç¤ºä¾‹

```typescript
eventOnButton("æŒ‰é”®åç§°", è¦æ³¨å†Œçš„å‡½æ•°);
```

## eventMakeLast <Badge type="warning" text="ğŸš«TavernHelper" />

è®© `listener` ç›‘å¬ `event_type`ï¼Œå½“äº‹ä»¶å‘ç”Ÿæ—¶è‡ªåŠ¨åœ¨æœ€åè¿è¡Œ `listener`ã€‚

å¦‚æœ `listener` å·²ç»åœ¨ç›‘å¬ `event_type`ï¼Œåˆ™è°ƒç”¨æœ¬å‡½æ•°ä¼šå°† `listener` è°ƒæ•´ä¸ºæœ€åè¿è¡Œã€‚

```typescript
function eventMakeLast<T extends EventType>(
  event_type: T,
  listener: ListenerType[T],
): void;
```

### å‚æ•°

#### `event_type`

- **ç±»å‹**: [`EventType`](./ç›‘å¬å’Œå‘é€äº‹ä»¶#äº‹ä»¶åˆ—è¡¨)
- **æè¿°**: è¦ç›‘å¬çš„äº‹ä»¶

#### `listener`

- **ç±»å‹**: `Function`
- **æè¿°**: è¦æ³¨å†Œ/è°ƒæ•´åˆ°æœ€åè¿è¡Œçš„å‡½æ•°

### ç¤ºä¾‹

```typescript
eventMakeLast(è¦ç›‘å¬çš„äº‹ä»¶, è¦æ³¨å†Œçš„å‡½æ•°);
```

## eventMakeFirst <Badge type="warning" text="ğŸš«TavernHelper" />

è®© `listener` ç›‘å¬ `event_type`ï¼Œå½“äº‹ä»¶å‘ç”Ÿæ—¶è‡ªåŠ¨åœ¨æœ€å…ˆè¿è¡Œ `listener`ã€‚

å¦‚æœ `listener` å·²ç»åœ¨ç›‘å¬ `event_type`ï¼Œåˆ™è°ƒç”¨æœ¬å‡½æ•°ä¼šå°† `listener` è°ƒæ•´ä¸ºæœ€å…ˆè¿è¡Œã€‚

```typescript
function eventMakeFirst<T extends EventType>(
  event_type: T,
  listener: ListenerType[T],
): void;
```

### å‚æ•°

#### `event_type`

- **ç±»å‹**: [`EventType`](./ç›‘å¬å’Œå‘é€äº‹ä»¶#äº‹ä»¶åˆ—è¡¨)
- **æè¿°**: è¦ç›‘å¬çš„äº‹ä»¶

#### `listener`

- **ç±»å‹**: `Function`
- **æè¿°**: è¦æ³¨å†Œ/è°ƒæ•´åˆ°æœ€å…ˆè¿è¡Œçš„å‡½æ•°

### ç¤ºä¾‹

```typescript
eventMakeFirst(è¦ç›‘å¬çš„äº‹ä»¶, è¦æ³¨å†Œçš„å‡½æ•°);
```

## eventOnce <Badge type="warning" text="ğŸš«TavernHelper" />

è®© `listener` ä»…ç›‘å¬ä¸‹ä¸€æ¬¡ `event_type`ï¼Œå½“è¯¥æ¬¡äº‹ä»¶å‘ç”Ÿæ—¶è¿è¡Œ `listener`, æ­¤åå–æ¶ˆç›‘å¬ã€‚

å¦‚æœ `listener` å·²ç»åœ¨ç›‘å¬ `event_type`ï¼Œåˆ™è°ƒç”¨æœ¬å‡½æ•°ä¸ä¼šæœ‰ä»»ä½•æ•ˆæœã€‚

```typescript
function eventOnce<T extends EventType>(
  event_type: T,
  listener: ListenerType[T],
): void;
```

### å‚æ•°

#### `event_type`

- **ç±»å‹**: [`EventType`](./ç›‘å¬å’Œå‘é€äº‹ä»¶#äº‹ä»¶åˆ—è¡¨)
- **æè¿°**: è¦ç›‘å¬çš„äº‹ä»¶

#### `listener`

- **ç±»å‹**: `Function`
- **æè¿°**: è¦æ³¨å†Œçš„å‡½æ•°

### ç¤ºä¾‹

```typescript
eventOnce(è¦ç›‘å¬çš„äº‹ä»¶, è¦æ³¨å†Œçš„å‡½æ•°);
```

## eventWaitOnce <Badge type="warning" text="ğŸš«TavernHelper" />

ç­‰å¾…ä¸€æ¬¡ `event_type` äº‹ä»¶å‘ç”Ÿï¼Œè¿”å›äº‹ä»¶æ•°æ®ã€‚

```typescript
function eventWaitOnce(event_type: EventType): Promise<any | undefined>;
```

### å‚æ•°

#### `event_type`

- **ç±»å‹**: [`EventType`](./ç›‘å¬å’Œå‘é€äº‹ä»¶#äº‹ä»¶åˆ—è¡¨)
- **æè¿°**: è¦ç­‰å¾…çš„äº‹ä»¶

### è¿”å›å€¼

- **ç±»å‹**: `Promise<any | undefined>`
- **æè¿°**: è¿”å›äº‹ä»¶ä¼ é€’çš„æ•°æ®

### ç¤ºä¾‹

```typescript
const messageId = await eventWaitOnce(tavern_events.MESSAGE_DELETED);
console.log(`æ¶ˆæ¯ ${messageId} è¢«åˆ é™¤äº†`);
```

## eventWaitOnce <Badge type="warning" text="ğŸš«TavernHelper" />

ç­‰å¾… `listener` ç›‘å¬åˆ°ä¸€æ¬¡ `event_type` ä¸”æ‰§è¡Œå®Œæˆï¼Œè¿”å› `listener` çš„æ‰§è¡Œç»“æœã€‚

åœ¨è°ƒç”¨æœ¬å‡½æ•°å‰, `listener` å¿…é¡»å·²ç»åœ¨ç›‘å¬ `event_type`ã€‚

```typescript
function eventWaitOnce<T extends EventType>(
  event_type: T,
  listener: ListenerType[T],
): Promise<any | undefined>;
```

### å‚æ•°

#### `event_type`

- **ç±»å‹**: [`EventType`](./ç›‘å¬å’Œå‘é€äº‹ä»¶#äº‹ä»¶åˆ—è¡¨)
- **æè¿°**: `listener` åœ¨ç›‘å¬çš„äº‹ä»¶

#### `listener`

- **ç±»å‹**: `Function`
- **æè¿°**: å·²ç»åœ¨ç›‘å¬ `event_type` çš„å‡½æ•°

### è¿”å›å€¼

- **ç±»å‹**: `Promise<any | undefined>`
- **æè¿°**: è¿”å› `listener` çš„æ‰§è¡Œç»“æœ

### ç¤ºä¾‹

```typescript
eventOnce("å­˜æ¡£", save);
const result = await eventWaitOnce("å­˜æ¡£", save);
console.log(`å­˜æ¡£ç»“æœ: ${result}`);
```

## eventEmit <Badge type="warning" text="ğŸš«TavernHelper" />

å‘é€ `event_type` äº‹ä»¶ï¼ŒåŒæ—¶å¯ä»¥å‘é€ä¸€äº›æ•°æ® `data`ã€‚

æ‰€æœ‰æ­£åœ¨ç›‘å¬ `event_type` æ¶ˆæ¯é¢‘é“çš„éƒ½ä¼šæ”¶åˆ°è¯¥æ¶ˆæ¯å¹¶æ¥æ”¶åˆ° `data`ã€‚

```typescript
function eventEmit<T extends EventType>(
  event_type: T,
  ...data: Parameters<ListenerType[T]>
): Promise<void>;
```

### å‚æ•°

#### `event_type`

- **ç±»å‹**: [`EventType`](./ç›‘å¬å’Œå‘é€äº‹ä»¶#äº‹ä»¶åˆ—è¡¨)
- **æè¿°**: è¦å‘é€çš„äº‹ä»¶

#### `data`

- **ç±»å‹**: `any[]`
- **æè¿°**: è¦éšç€äº‹ä»¶å‘é€çš„æ•°æ®

### ç¤ºä¾‹

:::code-group

```typescript [å‘é€"è§’è‰²é˜¶æ®µæ›´æ–°å®Œæˆ"äº‹ä»¶]
// å‘é€ "è§’è‰²é˜¶æ®µæ›´æ–°å®Œæˆ" äº‹ä»¶, æ‰€æœ‰ç›‘å¬è¯¥äº‹ä»¶çš„ `listener` éƒ½ä¼šè¢«è¿è¡Œ
eventEmit("è§’è‰²é˜¶æ®µæ›´æ–°å®Œæˆ");
```

```typescript [å‘é€"å­˜æ¡£"äº‹ä»¶]
// å‘é€ "å­˜æ¡£" äº‹ä»¶, å¹¶ç­‰å¾…æ‰€æœ‰ `listener` (ä¹Ÿè®¸æ˜¯è´Ÿè´£å­˜æ¡£çš„å‡½æ•°) æ‰§è¡Œå®Œæ¯•åæ‰ç»§ç»­
await eventEmit("å­˜æ¡£");
```

```typescript [å‘é€æ—¶æºå¸¦æ•°æ®]
// å‘é€æ—¶æºå¸¦æ•°æ® ["ä½ å¥½", 0]
eventEmit("äº‹ä»¶", "ä½ å¥½", 0);
```

:::

## eventEmitAndWait <Badge type="warning" text="ğŸš«TavernHelper" />

æºå¸¦ `data` è€Œå‘é€ `event_type` äº‹ä»¶å¹¶ç­‰å¾…äº‹ä»¶å¤„ç†ç»“æŸ.

```typescript
function eventEmitAndWait<T extends EventType>(
  event_type: T,
  ...data: Parameters<ListenerType[T]>
): void;
```

### å‚æ•°

#### `event_type`

- **ç±»å‹**: [`EventType`](./ç›‘å¬å’Œå‘é€äº‹ä»¶#äº‹ä»¶åˆ—è¡¨)
- **æè¿°**: è¦å‘é€çš„äº‹ä»¶

#### `data`

- **ç±»å‹**: `any[]`
- **æè¿°**: è¦éšç€äº‹ä»¶å‘é€çš„æ•°æ®

## eventRemoveListener <Badge type="warning" text="ğŸš«TavernHelper" />

è®© `listener` å–æ¶ˆå¯¹ `event_type` çš„ç›‘å¬ã€‚

å¦‚æœ `listener` æ²¡æœ‰ç›‘å¬ `event_type`ï¼Œåˆ™è°ƒç”¨æœ¬å‡½æ•°ä¸ä¼šæœ‰ä»»ä½•æ•ˆæœã€‚

```typescript
function eventRemoveListener<T extends EventType>(
  event_type: T,
  listener: ListenerType[T],
): void;
```

### å‚æ•°

#### `event_type`

- **ç±»å‹**: [`EventType`](./ç›‘å¬å’Œå‘é€äº‹ä»¶#äº‹ä»¶åˆ—è¡¨)
- **æè¿°**: è¦å‘é€çš„äº‹ä»¶

#### `listener`

- **ç±»å‹**: `Function`
- **æè¿°**: è¦å–æ¶ˆæ³¨å†Œçš„å‡½æ•°

### ç¤ºä¾‹

```typescript
eventRemoveListener(è¦å–æ¶ˆç›‘å¬çš„äº‹ä»¶, è¦å–æ¶ˆæ³¨å†Œçš„å‡½æ•°);
```

## eventClearEvent <Badge type="warning" text="ğŸš«TavernHelper" />

å–æ¶ˆæœ¬ iframe ä¸­å¯¹ `event_type` çš„æ‰€æœ‰ç›‘å¬ã€‚

```typescript
function eventClearEvent(event_type: EventType): void;
```

### å‚æ•°

#### `event_type`

- **ç±»å‹**: [`EventType`](./ç›‘å¬å’Œå‘é€äº‹ä»¶#äº‹ä»¶åˆ—è¡¨)
- **æè¿°**: è¦å–æ¶ˆç›‘å¬çš„äº‹ä»¶

## eventClearListener <Badge type="warning" text="ğŸš«TavernHelper" />

å–æ¶ˆæœ¬ iframe ä¸­ `listener` çš„æ‰€æœ‰ç›‘å¬ã€‚

```typescript
function eventClearListener(listener: Function): void;
```

### å‚æ•°

#### `listener`

- **ç±»å‹**: `Function`
- **æè¿°**: è¦å–æ¶ˆæ³¨å†Œçš„å‡½æ•°

## eventClearAll <Badge type="warning" text="ğŸš«TavernHelper" />

å–æ¶ˆæœ¬ iframe ä¸­å¯¹æ‰€æœ‰äº‹ä»¶çš„æ‰€æœ‰ç›‘å¬ã€‚

```typescript
function eventClearAll(): void;
```

## Quick Reply å‘½ä»¤

æˆ‘ä»¬è¿˜æä¾›äº† Quick Reply å‘½ä»¤ `/event-emit`ï¼Œå…è®¸ä½ é€šè¿‡åœ¨å¿«é€Ÿå›å¤ä¸­å‘é€äº‹ä»¶æ¥è§¦å‘ js ä»£ç ã€‚

:::code-group

```plaintext [å¿«é€Ÿå›å¤éƒ¨åˆ†]
/event-emit event="éšä¾¿ä»€ä¹ˆåç§°" data="è¿™æ˜¯ä¸€ä¸ª æ•°æ®" data={{user}}
```

```typescript [iframe éƒ¨åˆ†]
eventOn("éšä¾¿ä»€ä¹ˆåå­—", (data1, data2) => { console.info(data1, data2); });
```

:::
å½“æˆ‘ä»¬æŒ‰ä¸‹è¯¥å¿«é€Ÿå›å¤çš„æŒ‰é’®åï¼Œæ­£åœ¨ç›‘å¬ "äº‹ä»¶åç§°" æ¶ˆæ¯é¢‘é“çš„ js ä»£ç å°†ä¼šè·å¾— `data` å¹¶å¼€å§‹æ‰§è¡Œã€‚

## äº‹ä»¶åˆ—è¡¨

äº‹ä»¶å¯ä»¥æ˜¯ï¼š

- `iframe_events` ä¸­çš„ iframe äº‹ä»¶
- `tavern_events` ä¸­çš„é…’é¦†äº‹ä»¶
- è‡ªå®šä¹‰çš„å­—ç¬¦ä¸²äº‹ä»¶

:::details æ‰€æœ‰ iframe äº‹ä»¶

```typescript
const iframe_events = {
  MESSAGE_IFRAME_RENDER_STARTED: "message_iframe_render_started",
  MESSAGE_IFRAME_RENDER_ENDED: "message_iframe_render_ended",
  VARIABLES_UPDATED: 'variables_updated',  // å…¨å±€/èŠå¤©/éšæ¥¼å˜é‡é€šè¿‡é…’é¦†åŠ©æ‰‹çš„å‡½æ•°å¾—åˆ°æ›´æ–°
  GENERATION_STARTED: "js_generation_started", // `generate` å‡½æ•°å¼€å§‹ç”Ÿæˆ
  STREAM_TOKEN_RECEIVED_FULLY: "js_stream_token_received_fully", // å¯ç”¨æµå¼ä¼ è¾“çš„ `generate` å‡½æ•°ä¼ è¾“å½“å‰å®Œæ•´æ–‡æœ¬: "è¿™æ˜¯", "è¿™æ˜¯ä¸€æ¡", "è¿™æ˜¯ä¸€æ¡æµå¼ä¼ è¾“"
  STREAM_TOKEN_RECEIVED_INCREMENTALLY: "js_stream_token_received_incrementally", // å¯ç”¨æµå¼ä¼ è¾“çš„ `generate` å‡½æ•°ä¼ è¾“å½“å‰å¢é‡æ–‡æœ¬: "è¿™æ˜¯", "ä¸€æ¡", "æµå¼ä¼ è¾“"
  GENERATION_ENDED: "js_generation_ended", // `generate` å‡½æ•°å®Œæˆç”Ÿæˆ
};
```

:::

:::details æ‰€æœ‰é…’é¦†äº‹ä»¶

```typescript
const tavern_events = {
  APP_READY: "app_ready",
  EXTRAS_CONNECTED: "extras_connected",
  MESSAGE_SWIPED: "message_swiped",
  MESSAGE_SENT: "message_sent",
  MESSAGE_RECEIVED: "message_received",
  MESSAGE_EDITED: "message_edited",
  MESSAGE_DELETED: "message_deleted",
  MESSAGE_UPDATED: "message_updated",
  MESSAGE_FILE_EMBEDDED: "message_file_embedded",
  IMPERSONATE_READY: "impersonate_ready",
  CHAT_CHANGED: "chat_id_changed",
  GENERATION_AFTER_COMMANDS: "GENERATION_AFTER_COMMANDS",
  GENERATION_STARTED: "generation_started",
  GENERATION_STOPPED: "generation_stopped",
  GENERATION_ENDED: "generation_ended",
  EXTENSIONS_FIRST_LOAD: "extensions_first_load",
  EXTENSION_SETTINGS_LOADED: "extension_settings_loaded",
  SETTINGS_LOADED: "settings_loaded",
  SETTINGS_UPDATED: "settings_updated",
  GROUP_UPDATED: "group_updated",
  MOVABLE_PANELS_RESET: "movable_panels_reset",
  SETTINGS_LOADED_BEFORE: "settings_loaded_before",
  SETTINGS_LOADED_AFTER: "settings_loaded_after",
  CHATCOMPLETION_SOURCE_CHANGED: "chatcompletion_source_changed",
  CHATCOMPLETION_MODEL_CHANGED: "chatcompletion_model_changed",
  OAI_PRESET_CHANGED_BEFORE: "oai_preset_changed_before",
  OAI_PRESET_CHANGED_AFTER: "oai_preset_changed_after",
  OAI_PRESET_EXPORT_READY: "oai_preset_export_ready",
  OAI_PRESET_IMPORT_READY: "oai_preset_import_ready",
  WORLDINFO_SETTINGS_UPDATED: "worldinfo_settings_updated",
  WORLDINFO_UPDATED: "worldinfo_updated",
  CHARACTER_EDITED: "character_edited",
  CHARACTER_PAGE_LOADED: "character_page_loaded",
  CHARACTER_GROUP_OVERLAY_STATE_CHANGE_BEFORE:
    "character_group_overlay_state_change_before",
  CHARACTER_GROUP_OVERLAY_STATE_CHANGE_AFTER:
    "character_group_overlay_state_change_after",
  USER_MESSAGE_RENDERED: "user_message_rendered",
  CHARACTER_MESSAGE_RENDERED: "character_message_rendered",
  FORCE_SET_BACKGROUND: "force_set_background",
  CHAT_DELETED: "chat_deleted",
  CHAT_CREATED: "chat_created",
  GROUP_CHAT_DELETED: "group_chat_deleted",
  GROUP_CHAT_CREATED: "group_chat_created",
  GENERATE_BEFORE_COMBINE_PROMPTS: "generate_before_combine_prompts",
  GENERATE_AFTER_COMBINE_PROMPTS: "generate_after_combine_prompts",
  GENERATE_AFTER_DATA: "generate_after_data",
  GROUP_MEMBER_DRAFTED: "group_member_drafted",
  WORLD_INFO_ACTIVATED: "world_info_activated",
  TEXT_COMPLETION_SETTINGS_READY: "text_completion_settings_ready",
  CHAT_COMPLETION_SETTINGS_READY: "chat_completion_settings_ready",
  CHAT_COMPLETION_PROMPT_READY: "chat_completion_prompt_ready",
  CHARACTER_FIRST_MESSAGE_SELECTED: "character_first_message_selected",
  // TODO: Naming convention is inconsistent with other events
  CHARACTER_DELETED: "characterDeleted",
  CHARACTER_DUPLICATED: "character_duplicated",
  STREAM_TOKEN_RECEIVED: "stream_token_received",
  FILE_ATTACHMENT_DELETED: "file_attachment_deleted",
  WORLDINFO_FORCE_ACTIVATE: "worldinfo_force_activate",
  OPEN_CHARACTER_LIBRARY: "open_character_library",
  ONLINE_STATUS_CHANGED: "online_status_changed",
  IMAGE_SWIPED: "image_swiped",
  CONNECTION_PROFILE_LOADED: "connection_profile_loaded",
  TOOL_CALLS_PERFORMED: "tool_calls_performed",
  TOOL_CALLS_RENDERED: "tool_calls_rendered",
};
```

:::

:::details æŸ¥çœ‹äº‹ä»¶å‘ç”Ÿæ—¶ä¼šå‘é€çš„æ•°æ®

```typescript
type ListenerType = {
  [iframe_events.MESSAGE_IFRAME_RENDER_STARTED]: (iframe_name: string) => void;
  [iframe_events.MESSAGE_IFRAME_RENDER_ENDED]: (iframe_name: string) => void;
  [iframe_events.VARIABLES_UPDATED]: (
    type: 'global' | 'chat' | 'message',
    variables: Record<string, any>,
    message_info?: { message_id: number; swipe_id: number },
  ) => void;
  [iframe_events.GENERATION_STARTED]: () => void;
  [iframe_events.STREAM_TOKEN_RECEIVED_FULLY]: (full_text: string) => void;
  [iframe_events.STREAM_TOKEN_RECEIVED_INCREMENTALLY]: (incremental_text: string) => void;
  [iframe_events.GENERATION_ENDED]: (text: string) => void;

  [tavern_events.APP_READY]: () => void;
  [tavern_events.EXTRAS_CONNECTED]: (modules: any) => void;
  [tavern_events.MESSAGE_SWIPED]: (message_id: number) => void;
  [tavern_events.MESSAGE_SENT]: (message_id: number) => void;
  [tavern_events.MESSAGE_RECEIVED]: (message_id: number) => void;
  [tavern_events.MESSAGE_EDITED]: (message_id: number) => void;
  [tavern_events.MESSAGE_DELETED]: (message_id: number) => void;
  [tavern_events.MESSAGE_UPDATED]: (message_id: number) => void;
  [tavern_events.MESSAGE_FILE_EMBEDDED]: (message_id: number) => void;
  [tavern_events.IMPERSONATE_READY]: (message: string) => void;
  [tavern_events.CHAT_CHANGED]: (chat_file_name: string) => void;
  [tavern_events.GENERATION_AFTER_COMMANDS]: (
    type: string,
    option: {
      automatic_trigger?: boolean;
      force_name2?: boolean;
      quiet_prompt?: string;
      quietToLoud?: boolean;
      skipWIAN?: boolean;
      force_chid?: number;
      signal?: AbortSignal;
      quietImage?: string;
      quietName?: string;
      depth?: number;
    },
    dry_run: boolean,
  ) => void;
  [tavern_events.GENERATION_STARTED]: (
    type: string,
    option: {
      automatic_trigger?: boolean;
      force_name2?: boolean;
      quiet_prompt?: string;
      quietToLoud?: boolean;
      skipWIAN?: boolean;
      force_chid?: number;
      signal?: AbortSignal;
      quietImage?: string;
      quietName?: string;
      depth?: number;
    },
    dry_run: boolean,
  ) => void;
  [tavern_events.GENERATION_STOPPED]: () => void;
  [tavern_events.GENERATION_ENDED]: (message_id: number) => void;
  [tavern_events.EXTENSIONS_FIRST_LOAD]: () => void;
  [tavern_events.EXTENSION_SETTINGS_LOADED]: () => void;
  [tavern_events.SETTINGS_LOADED]: () => void;
  [tavern_events.SETTINGS_UPDATED]: () => void;
  [tavern_events.GROUP_UPDATED]: () => void;
  [tavern_events.MOVABLE_PANELS_RESET]: () => void;
  [tavern_events.SETTINGS_LOADED_BEFORE]: (settings: Object) => void;
  [tavern_events.SETTINGS_LOADED_AFTER]: (settings: Object) => void;
  [tavern_events.CHATCOMPLETION_SOURCE_CHANGED]: (source: string) => void;
  [tavern_events.CHATCOMPLETION_MODEL_CHANGED]: (model: string) => void;
  [tavern_events.OAI_PRESET_CHANGED_BEFORE]: (result: {
    preset: Object;
    presetName: string;
    settingsToUpdate: Object;
    settings: Object;
    savePreset: Function;
  }) => void;
  [tavern_events.OAI_PRESET_CHANGED_AFTER]: () => void;
  [tavern_events.OAI_PRESET_EXPORT_READY]: (preset: Object) => void;
  [tavern_events.OAI_PRESET_IMPORT_READY]: (result: { data: Object; presetName: string }) => void;
  [tavern_events.WORLDINFO_SETTINGS_UPDATED]: () => void;
  [tavern_events.WORLDINFO_UPDATED]: (name: string, data: { entries: Object[] }) => void;
  [tavern_events.CHARACTER_EDITED]: (result: { detail: { id: string; character: Object } }) => void;
  [tavern_events.CHARACTER_PAGE_LOADED]: () => void;
  [tavern_events.CHARACTER_GROUP_OVERLAY_STATE_CHANGE_BEFORE]: (state: number) => void;
  [tavern_events.CHARACTER_GROUP_OVERLAY_STATE_CHANGE_AFTER]: (state: number) => void;
  [tavern_events.USER_MESSAGE_RENDERED]: (message_id: number) => void;
  [tavern_events.CHARACTER_MESSAGE_RENDERED]: (message_id: number) => void;
  [tavern_events.FORCE_SET_BACKGROUND]: (background: { url: string; path: string }) => void;
  [tavern_events.CHAT_DELETED]: (chat_file_name: string) => void;
  [tavern_events.CHAT_CREATED]: () => void;
  [tavern_events.GROUP_CHAT_DELETED]: (chat_file_name: string) => void;
  [tavern_events.GROUP_CHAT_CREATED]: () => void;
  [tavern_events.GENERATE_BEFORE_COMBINE_PROMPTS]: () => void;
  [tavern_events.GENERATE_AFTER_COMBINE_PROMPTS]: (result: { prompt: string; dryRun: boolean }) => void;
  [tavern_events.GENERATE_AFTER_DATA]: (generate_data: Object) => void;
  [tavern_events.GROUP_MEMBER_DRAFTED]: (character_id: string) => void;
  [tavern_events.WORLD_INFO_ACTIVATED]: (entries: any[]) => void;
  [tavern_events.TEXT_COMPLETION_SETTINGS_READY]: () => void;
  [tavern_events.CHAT_COMPLETION_SETTINGS_READY]: (generate_data: {
    messages: { role: string; content: string }[];
    model: string;
    temprature: number;
    frequency_penalty: number;
    presence_penalty: number;
    top_p: number;
    max_tokens: number;
    stream: boolean;
    logit_bias: Object;
    stop: string[];
    chat_comletion_source: string;
    n?: number;
    user_name: string;
    char_name: string;
    group_names: string[];
    include_reasoning: boolean;
    reasoning_effort: string;
    [others: string]: any;
  }) => void;
  [tavern_events.CHAT_COMPLETION_PROMPT_READY]: (event_data: {
    chat: { role: string; content: string }[];
    dryRun: boolean;
  }) => void;
  [tavern_events.CHARACTER_FIRST_MESSAGE_SELECTED]: (event_args: {
    input: string;
    output: string;
    character: Object;
  }) => void;
  [tavern_events.CHARACTER_DELETED]: (result: { id: string; character: Object }) => void;
  [tavern_events.CHARACTER_DUPLICATED]: (result: { oldAvatar: string; newAvatar: string }) => void;
  [tavern_events.STREAM_TOKEN_RECEIVED]: (text: string) => void;
  [tavern_events.FILE_ATTACHMENT_DELETED]: (url: string) => void;
  [tavern_events.WORLDINFO_FORCE_ACTIVATE]: (entries: Object[]) => void;
  [tavern_events.OPEN_CHARACTER_LIBRARY]: () => void;
  [tavern_events.ONLINE_STATUS_CHANGED]: () => void;
  [tavern_events.IMAGE_SWIPED]: (result: {
    message: Object;
    element: JQuery<HTMLElement>;
    direction: 'left' | 'right';
  }) => void;
  [tavern_events.CONNECTION_PROFILE_LOADED]: (profile_name: string) => void;
  [tavern_events.TOOL_CALLS_PERFORMED]: (tool_invocations: Object[]) => void;
  [tavern_events.TOOL_CALLS_RENDERED]: (tool_invocations: Object[]) => void;
  [custom_event: string]: (...args: any) => any;
};
```

:::
