---
order: 3
---

# 注入提示词

:::tip
请务必先阅读[如何正确使用酒馆助手](/guide/基本用法/如何正确使用酒馆助手.md)
:::

[点击查看对应类型定义文件 (可发给 AI 或 IDE 使用, 酒馆助手界面中提供了打包下载)](https://github.com/N0VI028/JS-Slash-Runner/blob/main/%40types/function/inject.d.ts)

<CustomTOC />

## injectPrompts

注入提示词

这样注入的提示词仅在当前聊天文件中有效,

- 如果需要跨聊天文件注入或在新开聊天时重新注入, 你可以监听 `tavern_events.CHAT_CHANGED` 事件
- 或者, 可以监听 `tavern_events.GENERATION_AFTER_COMMANDS` 事件, 在生成前注入

:::code-group

```ts [injectPrompts]
function injectPrompts(prompts: InjectionPrompt[], options?: injectPromptsOptions): { uninject: () => void };
```

```ts [injectPromptsOptions]
type injectPromptsOptions = {
  once?: boolean;
};
```

:::

### 参数

#### `prompts`

- **类型**: `InjectionPrompt[]`
- **描述**: 要注入的提示词

#### `option?`

- **类型**: `injectPromptsOptions`
- **描述**: 可选选项

##### `once?`

- **类型**: `boolean`
- **描述**: 是否只在下一次请求生成中有效; 默认为 false

### 返回值

- **后续操作**
  - `uninject`: 取消注入这个提示词

## uninjectPrompts

移除注入的提示词

```ts
function uninjectPrompts(ids: string[]): void;
```

### 参数

#### `ids`

- **类型**: `string[]`
- **描述**: 要移除的提示词的 id 列表

## 参数详情

### `InjectionPrompt`

```ts
type InjectionPrompt = {
  id: string;
  /**
   * 要注入的位置
   * - 'in_chat': 插入到聊天中
   * - 'none': 不会发给 AI, 但能用来激活世界书条目.
   */
  position: 'in_chat' | 'none';
  depth: number;

  role: 'system' | 'assistant' | 'user';
  content: string;

  /** 提示词在什么情况下启用; 默认为始终 */
  filter?: (() => boolean) | (() => Promise<boolean>);
  /** 是否作为欲扫描文本, 加入世界书绿灯条目扫描文本中; 默认为任意 */
  should_scan?: boolean;
};
```
