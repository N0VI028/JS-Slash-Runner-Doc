---
order: 11
---

# è®¿é—®æ¥å£

:::tip
è¯·åŠ¡å¿…å…ˆé˜…è¯»[å¦‚ä½•æ­£ç¡®ä½¿ç”¨é…’é¦†åŠ©æ‰‹](/guide/åŸºæœ¬ç”¨æ³•/å¦‚ä½•æ­£ç¡®ä½¿ç”¨é…’é¦†åŠ©æ‰‹.md)
:::

<CustomTOC />

## SillyTavern

é€šè¿‡ `SillyTavern`, ä½ å¯ä»¥è®¿é—®é…’é¦†æä¾›ç»™æ‰©å±•çš„ç¨³å®šæ¥å£. é…’é¦†åŠ©æ‰‹ä¸ºå®ƒä»¬é¢å¤–æä¾›äº†[ç±»å‹å®šä¹‰](https://github.com/N0VI028/JS-Slash-Runner/blob/main/%40types/iframe/exported.sillytavern.d.ts)å¹¶é¢å¤–å¯¼å‡ºäº†[ä¸€äº›æ¥å£](https://github.com/N0VI028/JS-Slash-Runner/blob/main/%40types/function/builtin.d.ts).

è€Œé…’é¦†åŠ©æ‰‹åœ¨é…’é¦†æ¥å£ä¹‹å¤–, æä¾›äº†æ›´å¤šæ›´ç›´æ¥çš„åŠŸèƒ½.

:::code-group

```ts [SillyTavern]
/**
 * é…’é¦†æä¾›ç»™æ’ä»¶çš„ç¨³å®šæ¥å£, å…·ä½“å†…å®¹è§äº https://github.com/SillyTavern/SillyTavern/blob/release/public/scripts/st-context.js#L76
 * ä½ ä¹Ÿå¯ä»¥åœ¨é…’é¦†é¡µé¢æŒ‰ f12, åœ¨æ§åˆ¶å°ä¸­è¾“å…¥ `window.SillyTavern.getContext()` æ¥æŸ¥çœ‹å½“å‰é…’é¦†æ‰€æä¾›çš„æ¥å£
 */
const SillyTavern;
```

```ts [builtin]
/** é™¤äº†é…’é¦†æœ¬æ¥å¯¼å‡ºçš„æ¥å£, é…’é¦†åŠ©æ‰‹é¢å¤–å¯¼å‡ºäº†ä¸€äº›é…’é¦†æ¥å£ */
const builtin;
```

:::

### ç¤ºä¾‹

```ts
// è·å–ç¬¬ 0 æ¡æ¶ˆæ¯çš„æ•°æ®
alert(JSON.stringify(SillyTavern.chat[0]));
```

## TavernHelper

é€šè¿‡ `TavernHelper`, å…¶ä»–æ‰©å±•ä¹Ÿå¯ä»¥è®¿é—®é…’é¦†åŠ©æ‰‹æä¾›çš„ç¨³å®šæ¥å£, å¯ç”¨æ¥å£ä¸ºåŠŸèƒ½è¯¦æƒ…ä¸­çš„å…¨éƒ¨å†…å®¹.

æˆ‘ä»¬ä¸ºé…’é¦†æ’ä»¶ä¹Ÿæä¾›äº†[åŸºäº Viteã€Vue å’Œ Pinia çš„ç¼–å†™æ¨¡æ¿](http://github.com/StageDog/tavern_extension_template); å½“ç„¶é…’é¦†åŠ©æ‰‹è„šæœ¬ç›¸æ¯”äºé…’é¦†æ’ä»¶æ›´ä¸ºæ–¹ä¾¿, å› æ­¤æˆ‘ä»¬æä¾›äº†[é…’é¦†åŠ©æ‰‹å‰ç«¯ç•Œé¢æˆ–è„šæœ¬ç¼–å†™æ¨¡æ¿](https://github.com/StageDog/tavern_helper_template).

ä¸ºäº†è®©è½¯ä»¶èƒ½æ­£ç¡®è¯†åˆ«é…’é¦†åŠ©æ‰‹åŠŸèƒ½, ä½ éœ€è¦ä¸‹è½½ã€è§£å‹[@types.zip](https://gitlab.com/novi028/JS-Slash-Runner/-/raw/main/dist/@types.zip?ref_type=heads&inline=false), å¹¶åœ¨ `tsconfig.json` çš„ `include` éƒ¨åˆ†æ·»åŠ å®ƒ.

### ç¤ºä¾‹

```ts
// è·å–å½“å‰è§’è‰²å¡çš„å¤´åƒè·¯å¾„
alert(TavernHelper.getCharAvatarPath());
```

::: warning
åœ¨åŠŸèƒ½è¯¦æƒ…æ–‡æ¡£ä¸­, æœªå¯¼å‡ºåˆ° window å¯¹è±¡çš„å‡½æ•°ä¼šä½¿ç”¨ `ğŸš«TavernHelper` æ ‡è®°. è¿™äº›å‡½æ•°åœ¨æ‰©å±•ä¸­æ— æ³•ç›´æ¥é€šè¿‡ `TavernHelper` è°ƒç”¨.
:::

## æç¤ºè¯æ¨¡æ¿

é€šè¿‡ `EjsTemplate`, ä½ å¯ä»¥è®¿é—®[æç¤ºè¯æ¨¡æ¿](https://github.com/zonde306/ST-Prompt-Template)æä¾›çš„æ¥å£. é…’é¦†åŠ©æ‰‹ä¸ºå®ƒä»¬é¢å¤–æä¾›äº†[ç±»å‹å®šä¹‰](https://github.com/N0VI028/JS-Slash-Runner/blob/main/%40types/iframe/exported.ejstemplate.d.ts).

```ts
/**
 * æç¤ºè¯æ¨¡æ¿è¯­æ³•æ’ä»¶æ‰€æä¾›çš„é¢å¤–åŠŸèƒ½, å¿…é¡»é¢å¤–å®‰è£…æç¤ºè¯æ¨¡æ¿è¯­æ³•æ’ä»¶, å…·ä½“å†…å®¹è§äº https://github.com/zonde306/ST-Prompt-Template
 * ä½ ä¹Ÿå¯ä»¥åœ¨é…’é¦†é¡µé¢æŒ‰ f12, åœ¨æ§åˆ¶å°ä¸­è¾“å…¥ `window.EjsTemplate` æ¥æŸ¥çœ‹å½“å‰æç¤ºè¯æ¨¡æ¿è¯­æ³•æ‰€æä¾›çš„æ¥å£
 */
const EjsTemplate;
```

## MVU å˜é‡æ¡†æ¶

é€šè¿‡ `Mvu`, ä½ å¯ä»¥è®¿é—®[MVU å˜é‡æ¡†æ¶](https://github.com/MagicalAstrogy/MagVarUpdate)æä¾›çš„æ¥å£. é…’é¦†åŠ©æ‰‹ä¸ºå®ƒä»¬é¢å¤–æä¾›äº†[ç±»å‹å®šä¹‰](https://github.com/N0VI028/JS-Slash-Runner/blob/main/%40types/iframe/exported.mvu.d.ts).

```ts
/**
 * mvu å˜é‡æ¡†æ¶è„šæœ¬æä¾›çš„é¢å¤–åŠŸèƒ½, å¿…é¡»é¢å¤–å®‰è£… mvu å˜é‡æ¡†æ¶è„šæœ¬, å…·ä½“å†…å®¹è§äº https://github.com/MagicalAstrogy/MagVarUpdate/blob/master/src/export_globals.ts
 * **åœ¨ä½¿ç”¨å®ƒä¹‹å‰, ä½ åº”è¯¥å…ˆé€šè¿‡ `await waitGlobalInitialized('Mvu')` æ¥ç­‰å¾… Mvu åˆå§‹åŒ–å®Œæ¯•**
 * ä½ ä¹Ÿå¯ä»¥åœ¨é…’é¦†é¡µé¢æŒ‰ f12, åœ¨æ§åˆ¶å°ä¸­è¾“å…¥ `window.Mvu` æ¥æŸ¥çœ‹å½“å‰ Mvu å˜é‡æ¡†æ¶æ‰€æä¾›çš„æ¥å£
 */
declare const Mvu;
```

### ç¤ºä¾‹

```ts
const old_data = Mvu.getMvuData({ type: 'message', message_id: 'latest' });
const new_data = await Mvu.parseMessage("_.set('è§’è‰².ç»œç»œ.å¥½æ„Ÿåº¦', 30); // å¼ºåˆ¶ä¿®æ”¹", old_data);
await Mvu.replaceMvuData(new_data, { type: 'message', message_id: 'latest' });
```
